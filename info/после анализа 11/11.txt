
# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é –æ—à–∏–±–æ–∫ –æ–±—É—á–µ–Ω–∏—è –Ω–µ–π—Ä–æ—Å–µ—Ç–∏

–í –æ—Ç–≤–µ—Ç –Ω–∞ –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–≥—Ä—É–∂–∞–µ–º—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —à–∞–≥–∏ –∏ –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞.

## 1. –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö —Ç–∏–∫–µ—Ä–æ–≤
–ï—Å–ª–∏ —Å–µ–π—á–∞—Å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤—Å–µ–≥–æ 50 —Å–∏–º–≤–æ–ª–æ–≤, —ç—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –∏–∑ —Ñ–∞–π–ª–∞ `tickers_data.json` —á–∏—Ç–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∏–ª–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–¥—É–ª—å `TickerDataLoader`, –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ —É–º–µ–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å –≤—Å–µ —Å–∏–º–≤–æ–ª—ã –∏–∑ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø—Ä–æ—Å–º–æ—Ç—Ä—â–∏–∫–∞ —Ç–∏–∫–µ—Ä–æ–≤:

```python
from src.tools.ticker_data_loader import TickerDataLoader

# –∑–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å–∏–º–≤–æ–ª–æ–≤
loader = TickerDataLoader()
all_symbols = list(loader.data.keys())  # –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å ~681 —Å–∏–º–≤–æ–ª–æ–≤
print(f"–í—Å–µ–≥–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ —Å–∏–º–≤–æ–ª–æ–≤: {len(all_symbols)}")
```

–ï—Å–ª–∏ –≤—ã –ø–æ‚Äë–ø—Ä–µ–∂–Ω–µ–º—É –ø–æ–ª—É—á–∞–µ—Ç–µ –º–∞–ª–µ–Ω—å–∫–∏–π —Å–ø–∏—Å–æ–∫, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ `tickers_data.json` —Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è –≤—Å–µ –ø–∞—Ä—ã. –≠—Ç–æ—Ç —Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –∫–∞—Ç–∞–ª–æ–≥–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Ç–∏–∫–µ—Ä–æ–≤ (`AppData\Local\BybitTradingBot\data` –Ω–∞ Windows); —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –µ–≥–æ –≤ –∫–∞—Ç–∞–ª–æ–≥ —Å –ø—Ä–æ–≥—Ä–∞–º–º–æ–π –æ–±—É—á–µ–Ω–∏—è –∏–ª–∏ –ø–µ—Ä–µ–¥–∞–π—Ç–µ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –≤ `TickerDataLoader`.

## 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ `Category is invalid` –∏ `Not supported symbols`
Bybit V5 API —Ä–∞–∑–ª–∏—á–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: `spot`, `linear`, `inverse`, `option`. –û—à–∏–±–∫–∞ ¬´params error: Category is invalid¬ª –≤–æ–∑–Ω–∏–∫–∞–µ—Ç, –µ—Å–ª–∏ –≤—ã–±—Ä–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é, –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—É—é –¥–ª—è –¥–∞–Ω–Ω–æ–π –ø–∞—Ä—ã. –û—à–∏–±–∫–∞ ¬´Not supported symbols¬ª –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Å–≤–µ—á–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –≤–æ–≤—Å–µ (—á–∞—Å—Ç–æ —ç—Ç–æ –Ω–æ–≤—ã–µ –∏–ª–∏ –Ω–∏–∑–∫–æ–ª–∏–∫–≤–∏–¥–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã). –ò—Å–ø—Ä–∞–≤—å—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –¥–æ–±–∞–≤—å—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç:

```python
def choose_category(symbol: str) -> str:
    # –ü—Ä–æ—Å—Ç–∞—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∞: –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–ø–æ—Ç‚Äë–ø–∞—Ä ('...USDT') –∏—Å–ø–æ–ª—å–∑—É–µ–º spot;
    # –¥–ª—è —Ñ—å—é—á–µ—Ä—Å–æ–≤ –ø—Ä–æ–±—É–µ–º linear
    if symbol.endswith('USDT'):
        return 'spot'
    return 'linear'

# –∑–∞–≥—Ä—É–∑–∫–∞ —Å–≤–µ—á–µ–π
try:
    klines = client.get_kline(category=choose_category(symbol), symbol=symbol, interval='60', limit=200)
except Exception as e:
    # –µ—Å–ª–∏ –≤–µ—Ä–Ω—É–ª—Å—è params error, –ø—Ä–æ–±—É–µ–º –¥—Ä—É–≥—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
    alt = 'linear' if choose_category(symbol) == 'spot' else 'spot'
    klines = client.get_kline(category=alt, symbol=symbol, interval='60', limit=200)
# –µ—Å–ª–∏ –ø–æ‚Äë–ø—Ä–µ–∂–Ω–µ–º—É –ø—É—Å—Ç–æ –∏–ª–∏ –æ—à–∏–±–∫–∞ "Not supported symbols", –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –ø–∞—Ä—É
```

–ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–∏–∫–µ—Ä—ã –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π —Å–µ—Ç–∏ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –≤–æ–æ–±—â–µ. –û—Å—Ç–∞–≤–ª—è–π—Ç–µ –∏—Ö –±–µ–∑ –æ–±—Ä–∞–±–æ—Ç–∫–∏.

## 3. –û–±—É—á–µ–Ω–∏–µ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö
–°–æ–æ–±—â–µ–Ω–∏–µ ¬´–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö: 0 < 100¬ª –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ –≤—ã —Ç—Ä–µ–±—É–µ—Ç–µ –∫–∞–∫ –º–∏–Ω–∏–º—É–º 100 –æ–±—É—á–∞—é—â–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤. –ß—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ –¥–∞–∂–µ –ø—Ä–∏ –º–∞–ª–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Å–≤–µ—á–µ–π:

1. –£–º–µ–Ω—å—à–∏—Ç–µ `feature_window` –¥–æ 20 (–∏–ª–∏ 10), —á—Ç–æ–±—ã –∏–∑ 200 —Å–≤–µ—á–µ–π –ø–æ–ª—É—á–∏–ª–æ—Å—å –±–æ–ª—å—à–µ –æ–∫–æ–Ω.
2. –£–±–µ—Ä–∏—Ç–µ –∂—ë—Å—Ç–∫–æ–µ —É—Å–ª–æ–≤–∏–µ `len(labels) < 100`, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–∞–∂–µ 10‚Äì20 –ø—Ä–∏–º–µ—Ä–æ–≤:

```python
if len(labels) < 10:
    # –ø—Ä–æ–ø—É—Å–∫–∞–µ–º, –µ—Å–ª–∏ —Å–æ–≤—Å–µ–º –º–∞–ª–æ
    continue
# –∏–Ω–∞—á–µ —Ç—Ä–µ–Ω–∏—Ä—É–µ–º
self.ml_strategy.train_model(symbol, features, labels)
```

3. –ü—Ä–∏ —Ä–∞—Å—á—ë—Ç–µ –¥–æ–≤–µ—Ä–∏—è (`confidence`) –º–∞—Å—à—Ç–∞–±–∏—Ä—É–π—Ç–µ –µ–≥–æ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —á–∏—Å–ª–∞ –ø—Ä–∏–º–µ—Ä–æ–≤, –∫–∞–∫ –±—ã–ª–æ –æ–ø–∏—Å–∞–Ω–æ —Ä–∞–Ω–µ–µ:

```python
confidence *= len(labels) / 100.0  # –µ—Å–ª–∏ –ø—Ä–∏–º–µ—Ä–æ–≤ –º–µ–Ω—å—à–µ 100, –¥–æ–≤–µ—Ä–∏–µ –Ω–∏–∂–µ
```

## 4. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è `performance` –≤ AdaptiveMLStrategy
–ß—Ç–æ–±—ã –Ω–µ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞ `no attribute 'performance'`, –¥–æ–±–∞–≤—å—Ç–µ –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä `AdaptiveMLStrategy` –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é —Å–ª–æ–≤–∞—Ä—è –º–µ—Ç—Ä–∏–∫:

```python
class AdaptiveMLStrategy:
    def __init__(...):
        ...
        self.performance: Dict[str, Dict[str, float]] = {}  # —Ö—Ä–∞–Ω–∏—Ç —Ç–æ—á–Ω–æ—Å—Ç—å –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–º–µ—Ä–æ–≤
```

–ò –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –µ–≥–æ –≤ `train_model`:

```python
from sklearn.metrics import accuracy_score
...
def train_model(self, symbol: str, features: List[List[float]], labels: List[int]):
    ...
    if test_labels:
        acc = accuracy_score(test_labels, test_pred)
        self.performance[symbol] = {'accuracy': acc, 'samples': len(labels)}
```

GUI‚Äë–º–æ–Ω–∏—Ç–æ—Ä –º–æ–∂–µ—Ç –∑–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `self.ml_strategy.performance` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞.

## 5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API
–í —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–º —Ü–∏–∫–ª–µ –¥–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –∏—Å–∫–ª—é—á–µ–Ω–∏–π. –í —Å–ª—É—á–∞–µ `Not supported symbols` –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ç–∏–∫–µ—Ä—É –∏ –ª–æ–≥–∏—Ä—É–π—Ç–µ:

```python
try:
    klines = client.get_kline(...)
except ApiError as e:
    print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ API –¥–ª—è {symbol}: {e}")
    continue
if not klines or len(klines) < window+1:
    print(f"‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è {symbol}: {len(klines)} < {window+1}")
    continue
```

## 6. –ü—Ä–∏–º–µ—Ä –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –æ–±—É—á–∞—é—â–µ–≥–æ —Ü–∏–∫–ª–∞
–ù–∏–∂–µ –ø—Å–µ–≤–¥–æ–∫–æ–¥ –∫–ª—é—á–µ–≤–æ–≥–æ —Ü–∏–∫–ª–∞ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –≤–∞—à–µ–≥–æ GUI‚Äë–º–æ–Ω–∏—Ç–æ—Ä–∞:

```python
loader = TickerDataLoader()
all_symbols = list(loader.data.keys())

success_count = 0
error_count = 0
for idx, symbol in enumerate(all_symbols, start=1):
    print(f"üìä –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è {symbol} ({idx}/{len(all_symbols)})...")
    # –≤—ã–±–∏—Ä–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é
    category = choose_category(symbol)
    try:
        klines = client.get_kline(category=category, symbol=symbol, interval='60', limit=200)
    except Exception:
        # –ø—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É
        alt = 'linear' if category == 'spot' else 'spot'
        klines = client.get_kline(category=alt, symbol=symbol, interval='60', limit=200)
    if not klines or len(klines) < 30:
        print(f"‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è {symbol}: {len(klines)} < 30")
        error_count += 1
        continue
    features, labels = [], []
    window = self.ml_strategy.feature_window
    for i in range(window, len(klines) - 1):
        feat = self.ml_strategy.extract_features(klines[i-window:i])
        if feat:
            features.append(feat)
            change = (float(klines[i+1]['close']) - float(klines[i]['close'])) / float(klines[i]['close'])
            labels.append(1 if change > 0.002 else -1 if change < -0.002 else 0)
    if len(labels) < 10:
        print(f"‚ö†Ô∏è –°–ª–∏—à–∫–æ–º –º–∞–ª–æ –æ–±—É—á–∞—é—â–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ –¥–ª—è {symbol}: {len(labels)}")
        error_count += 1
        continue
    self.ml_strategy.train_model(symbol, features, labels)
    self.ml_strategy.save_models()
    success_count += 1
print(f"üéâ –û–±—É—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!\nüìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: —É—Å–ø–µ—à–Ω–æ {success_count}, –æ—à–∏–±–æ–∫ {error_count} –∏–∑ {len(all_symbols)}")
```

–≠—Ç–æ—Ç –∫–æ–¥ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ —Å–∏–º–≤–æ–ª—ã, –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ, –æ–±—É—á–∞–µ—Ç –º–æ–¥–µ–ª–∏ –¥–∞–∂–µ –Ω–∞ –Ω–µ–±–æ–ª—å—à–æ–º –æ–±—ä—ë–º–µ –¥–∞–Ω–Ω—ã—Ö –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å.

## 7. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ (`trading_bot_main.py`) –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—ã–∑—ã–≤–∞–µ—Ç `self.ml_strategy.load_models()`. –û–Ω–∞ –¥–æ–ª–∂–Ω–∞ –≤–∏–¥–µ—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∏ –º–æ–¥–µ–ª–∏, —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –æ–±—É—á–∞—é—â–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º, –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤.

---

–°–ª–µ–¥—É—è —ç—Ç–∏–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º, –≤—ã —Å–º–æ–∂–µ—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–∏–∫–µ—Ä–æ–≤, –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –æ—à–∏–±–∫–∏ API, –æ–±—É—á–∞—Ç—å –º–æ–¥–µ–ª–∏ –¥–∞–∂–µ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö, —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –æ–±—É—á–µ–Ω–∏—è. –í—Å–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —Å–Ω–∞–±–∂–µ–Ω—ã –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –∫ –≤–∞—à–µ–π —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
